---
title: 第129章 代数几何在密码学中的应用：椭圆曲线密码学
description: 椭圆曲线密码学基础
section: 1
---

# 第一百二十九章：代数几何在密码学中的应用——椭圆曲线密码学

> **本章导读**：椭圆曲线密码学（ECC）是现代密码学的重要组成部分，它利用椭圆曲线上的代数结构来实现高效的加密和签名方案。本章将详细介绍椭圆曲线密码学的基础理论。

---

## 129.1 椭圆曲线密码学基础

### 129.1.1 椭圆曲线群结构

**定义 129.1.1（椭圆曲线群）**
> 设 $E$ 是定义在域 $K$ 上的椭圆曲线。点集 $E(K)$ 带有以下运算构成阿贝尔群：
> - 单位元：无穷远点 $\mathcal{O}$
> - 点加法：$P + Q + R = \mathcal{O}$ 当 $P, Q, R$ 共线

**例子 129.1.2（实数上的椭圆曲线）**
> $E: y^2 = x^3 + ax + b$，点加法公式：
> - $P = (x_1, y_1), Q = (x_2, y_2)$
> - $P + Q = (x_3, y_3)$ 其中
> $$x_3 = \lambda^2 - x_1 - x_2, \quad y_3 = \lambda(x_1 - x_3) - y_1$$
> $$\lambda = \begin{cases} \frac{y_2-y_1}{x_2-x_1} & P \neq Q \\ \frac{3x_1^2+a}{2y_1} & P = Q \end{cases}$$

### 129.1.2 有限域上的椭圆曲线

**定义 129.1.3（有限域椭圆曲线）**
> - **素域** $\mathbb{F}_p$：$E(\mathbb{F}_p): y^2 \equiv x^3 + ax + b \pmod p$
> - **二元域** $\mathbb{F}_{2^m}$：$E(\mathbb{F}_{2^m}): y^2 + xy = x^3 + ax + b$

**命题 129.1.4（Hasse 定理）**
> $$|\#E(\mathbb{F}_p) - (p+1)| \leq 2\sqrt{p}$$

---

## 129.2 椭圆曲线离散对数问题

### 129.2.1 ECDLP

**定义 129.2.1（ECDLP）**
> 给定 $P, Q \in E(K)$，求整数 $n$ 使得 $Q = nP$ 称为 **椭圆曲线离散对数问题**（ECDLP）。

**例子 129.2.2**
> 在 $P$ 的生成循环中，已知 $Q$ 求 $n$。

### 129.2.2 安全性

**ECDLP 的困难性**：
> - 没有已知的多项式时间算法
> - 亚指数算法（如 Pollard rho）复杂度为 $O(\sqrt{n})$
> - 160-bit 密钥相当于 RSA 1024-bit

---

## 129.3 密钥交换协议

### 129.3.1 Diffie-Hellman 协议

**协议 129.3.1（ECDH）**
> 1. Alice 选择私钥 $n_A$，公钥 $Q_A = n_A P$
> 2. Bob 选择私钥 $n_B$，公钥 $Q_B = n_B P$
> 3. 共享密钥：$n_A Q_B = n_B Q_A = n_A n_B P$

**安全性**：
> 取决于 ECDLP 的困难性

### 129.3.2 椭圆曲线参数

**定义 129.3.3（曲线参数）**
> - 素数 $p$（域大小）
> - 系数 $a, b$（曲线方程）
> - 基点 $G$（生成元）
> - 阶 $n$（基点的阶）
> - 余因子 $h = \#E(\mathbb{F}_p)/n$

---

## 129.4 加密方案

### 129.4.1 ECIES

**协议 129.4.1（ECIES）**
> **椭圆曲线集成加密方案**（ECIES）：
> 1. 发送方选择随机数 $r$，计算 $R = rP$
> 2. 计算共享密钥 $K = rQ_B$
> 3. 使用对称加密 $E_K(m)$ 加密消息
> 4. 发送 $(R, E_K(m))$

### 129.4.2 其他方案

**方案**：
> - **MQV 协议**：三方密钥交换
> - **ECIES**：集成加密标准

---

## 129.5 数字签名

### 129.5.1 ECDSA

**协议 129.5.1（ECDSA）**
> **椭圆曲线数字签名算法**：
> 1. 选择随机 $k$，计算 $R = (x_1, y_1) = kP$
> 2. 计算 $r = x_1 \mod n$
> 3. 计算 $s = k^{-1}(h(m) + d_A r) \mod n$
> 4. 签名：$(r, s)$

**验证**：
> 1. 计算 $u_1 = h(m) s^{-1} \mod n$，$u_2 = r s^{-1} \mod n$
> 2. 计算 $P_1 = u_1 G + u_2 Q_A$
> 3. 验证 $r \equiv x_1 \pmod n$

### 129.5.2 Schnorr 签名

**协议 129.5.2（Schnorr）**
> - 更短的签名
> - 证明安全性基于离散对数

---

## 129.6 椭圆曲线选型

### 129.6.1 NIST 曲线

**标准曲线**：
> - P-256：$y^2 = x^3 - 3x + b$ 在 $\mathbb{F}_p$ 上
> - P-384：更高级别安全
> - Curve25519：椭圆曲线 Diffie-Hellman

### 129.6.2 安全性考虑

**注意**：
> - 避免超奇异曲线（易受 MOV 攻击）
> - 避免异常曲线
> - 验证阶 $n$ 为大素数

---

## 129.7 习题

1. 实现椭圆曲线点加法算法。
2. 描述 ECDH 密钥交换的完整过程。
3. 分析 ECDSA 的安全性。

---

## 129.8 参考文献

1. **Washington, L. C.** *Elliptic Curves: Number Theory and Cryptography*. Chapman and Hall/CRC, 2008.
2. **Hankerson, D., Menezes, A., Vanstone, S.** *Guide to Elliptic Curve Cryptography**. Springer, 2004.
3. **Koblitz, N.** *Elliptic Curve Cryptography**. Mathematics of Computation, 1987.
